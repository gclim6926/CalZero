


cat > /tmp/ExportButton_new.jsx << 'EOF'
function ExportButton({ calibration, device }) {
  
  const exportJSON = () => {
    if (!calibration) return
    const data = {
      device: device,
      exportedAt: new Date().toISOString(),
      created_at: calibration.created_at,
      calibration_data: calibration.calibration_data
    }
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    const dateStr = new Date(calibration.created_at).toISOString().split('T')[0]
    a.download = `${device?.device_name || 'calibration'}_${dateStr}.json`
    a.click()
    URL.revokeObjectURL(url)
  }

  const exportCSV = () => {
    if (!calibration) return
    
    const joints = Object.keys(calibration.calibration_data)
    if (joints.length === 0) return
    
    // ë™ì ìœ¼ë¡œ ì†ì„± ëª©ë¡ ì¶”ì¶œ
    const firstJoint = calibration.calibration_data[joints[0]]
    const properties = firstJoint ? Object.keys(firstJoint) : []
    
    // CSV í—¤ë”
    let csv = 'joint,' + properties.join(',') + '\n'
    
    // CSV ë°ì´í„°
    joints.forEach(joint => {
      const data = calibration.calibration_data[joint] || {}
      const values = properties.map(prop => data[prop] !== undefined ? data[prop] : '')
      csv += joint + ',' + values.join(',') + '\n'
    })

    const blob = new Blob([csv], { type: 'text/csv' })
    const url = URL.createObjectURL(blob)
    const a = document.createElement('a')
    a.href = url
    const dateStr = new Date(calibration.created_at).toISOString().split('T')[0]
    a.download = `${device?.device_name || 'calibration'}_${dateStr}.csv`
    a.click()
    URL.revokeObjectURL(url)
  }

  return (
    <div className="flex gap-2">
      <button
        onClick={exportJSON}
        className="px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white text-xs rounded-lg transition"
      >
        ðŸ“¥ JSON
      </button>
      <button
        onClick={exportCSV}
        className="px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded-lg transition"
      >
        ðŸ“¥ CSV
      </button>
    </div>
  )
}

export default ExportButton
EOF
